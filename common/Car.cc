#include "Car.h"

Car::Car(GLuint vertexLoc, GLuint faceLoc, GLuint modelLoc,
        vec4 pos, GLfloat theta_x, GLfloat theta_y,GLfloat theta_z,
        GLfloat scale_x,GLfloat scale_y,GLfloat scale_z)
        : vertex_loc{vertexLoc}, face_loc{faceLoc},
        model_loc{modelLoc}
    {
        const vec4 point[110] = {
            vec4(-0.125, 0.0002, -0.1625, 1), //0
            vec4(-0.125, 0.25, -0.1625 ,1), //1
            vec4(0.125, 0.25, -0.1625 ,1), //2
            vec4(0.125, 0.0002, -0.1625, 1), //3
            vec4(-0.125, 0.0002, 0.1625, 1), //4 
            vec4(0.125, 0.0002, 0.1625, 1),//5
            vec4(0.125, 0.25, 0.1625 ,1), //6
            vec4(-0.125, 0.25, 0.1625, 1), //7
            vec4(-0.125, 0.25, 0.1625, 1), //8
            vec4(-0.125, 0.25, 0.1625, 1), //9
            vec4(-0.125, 0.0002, -0.1625, 1), //10
            vec4(-0.125, 0.25, -0.1625 ,1), //11
            vec4(0.125, 0.25, -0.1625 ,1), //12
            vec4(0.125, 0.0002, -0.1625, 1), //13
            vec4(-0.125, 0.0002, 0.1625, 1), //14 
            vec4(0.125, 0.0002, 0.1625, 1),//15
            vec4(0.125, 0.25, 0.1625 ,1), //16
            vec4(-0.125, 0.25, 0.1625, 1), //17
            vec4(-0.125, 0.25, 0.1625, 1), //18
            vec4(-0.125, 0.25, 0.1625, 1), //19
            vec4(-0.125, 0.0002, -0.1625, 1), //20
            vec4(-0.125, 0.25, -0.1625 ,1), //21
            vec4(0.125, 0.25, -0.1625 ,1), //22
            vec4(0.125, 0.0002, -0.1625, 1), //23
            vec4(-0.125, 0.0002, 0.1625, 1), //24 
            vec4(0.125, 0.0002, 0.1625, 1),//25
            vec4(0.125, 0.25, 0.1625 ,1), //26
            vec4(-0.125, 0.25, 0.1625, 1), //27
            vec4(-0.125, 0.25, 0.1625, 1), //28
            vec4(-0.125, 0.25, 0.1625, 1), //29
            vec4(-0.125, 0.0002, -0.1625, 1), //30
            vec4(-0.125, 0.25, -0.1625 ,1), //31
            vec4(0.125, 0.25, -0.1625 ,1), //32
            vec4(0.125, 0.0002, -0.1625, 1), //33
            vec4(-0.125, 0.0002, 0.1625, 1), //34 
            vec4(0.125, 0.0002, 0.1625, 1),//35
            vec4(0.125, 0.25, 0.1625 ,1), //36
            vec4(-0.125, 0.25, 0.1625, 1), //37
            vec4(-0.125, 0.25, 0.1625, 1), //38
            vec4(-0.125, 0.25, 0.1625, 1), //39
            vec4(-0.125, 0.0002, -0.1625, 1), //40
            vec4(-0.125, 0.25, -0.1625 ,1), //41
            vec4(0.125, 0.25, -0.1625 ,1), //42
            vec4(0.125, 0.0002, -0.1625, 1), //43
            vec4(-0.125, 0.0002, 0.1625, 1), //44 
            vec4(0.125, 0.0002, 0.1625, 1),//45
            vec4(0.125, 0.25, 0.1625 ,1), //46
            vec4(-0.125, 0.25, 0.1625, 1), //47
            vec4(-0.125, 0.25, 0.1625, 1), //48
            vec4(-0.125, 0.25, 0.1625, 1), //49
            vec4(-0.125, 0.0002, -0.1625, 1), //50
            vec4(-0.125, 0.25, -0.1625 ,1), //51
            vec4(0.125, 0.25, -0.1625 ,1), //52
            vec4(0.125, 0.0002, -0.1625, 1), //53
            vec4(-0.125, 0.0002, 0.1625, 1), //54 
            vec4(0.125, 0.0002, 0.1625, 1),//55
            vec4(0.125, 0.25, 0.1625 ,1), //56
            vec4(-0.125, 0.25, 0.1625, 1), //57
            vec4(-0.125, 0.25, 0.1625, 1), //58
            vec4(-0.125, 0.25, 0.1625, 1), //59
            vec4(-0.125, 0.0002, -0.1625, 1), //60
            vec4(-0.125, 0.25, -0.1625 ,1), //61
            vec4(0.125, 0.25, -0.1625 ,1), //62
            vec4(0.125, 0.0002, -0.1625, 1), //63
            vec4(-0.125, 0.0002, 0.1625, 1), //64 
            vec4(0.125, 0.0002, 0.1625, 1),//65
            vec4(0.125, 0.25, 0.1625 ,1), //66
            vec4(-0.125, 0.25, 0.1625, 1), //67
            vec4(-0.125, 0.25, 0.1625, 1), //68
            vec4(-0.125, 0.25, 0.1625, 1), //69
            vec4(-0.125, 0.0002, -0.1625, 1), //70
            vec4(-0.125, 0.25, -0.1625 ,1), //71
            vec4(0.125, 0.25, -0.1625 ,1), //72
            vec4(0.125, 0.0002, -0.1625, 1), //73
            vec4(-0.125, 0.0002, 0.1625, 1), //74 
            vec4(0.125, 0.0002, 0.1625, 1),//75
            vec4(0.125, 0.25, 0.1625 ,1), //76
            vec4(-0.125, 0.25, 0.1625, 1), //77
            vec4(-0.125, 0.25, 0.1625, 1), //78
            vec4(-0.125, 0.25, 0.1625, 1), //79
            vec4(-0.125, 0.0002, -0.1625, 1), //80
            vec4(-0.125, 0.25, -0.1625 ,1), //81
            vec4(0.125, 0.25, -0.1625 ,1), //82
            vec4(0.125, 0.0002, -0.1625, 1), //83
            vec4(-0.125, 0.0002, 0.1625, 1), //84 
            vec4(0.125, 0.0002, 0.1625, 1),//85
            vec4(0.125, 0.25, 0.1625 ,1), //86
            vec4(-0.125, 0.25, 0.1625, 1), //87
            vec4(-0.125, 0.25, 0.1625, 1), //88
            vec4(-0.125, 0.25, 0.1625, 1), //89
            vec4(-0.125, 0.0002, -0.1625, 1), //90
            vec4(-0.125, 0.25, -0.1625 ,1), //91
            vec4(0.125, 0.25, -0.1625 ,1), //92
            vec4(0.125, 0.0002, -0.1625, 1), //93
            vec4(-0.125, 0.0002, 0.1625, 1), //94 
            vec4(0.125, 0.0002, 0.1625, 1),//95
            vec4(0.125, 0.25, 0.1625 ,1), //96
            vec4(-0.125, 0.25, 0.1625, 1), //97
            vec4(-0.125, 0.25, 0.1625, 1), //98
            vec4(-0.125, 0.25, 0.1625, 1), //99
            vec4(0.125, 0.0002, -0.1625, 1), //100
            vec4(-0.125, 0.0002, 0.1625, 1), //101 
            vec4(0.125, 0.0002, 0.1625, 1),//102
            vec4(0.125, 0.25, 0.1625 ,1), //103
            vec4(-0.125, 0.25, 0.1625, 1), //104
            vec4(-0.125, 0.25, 0.1625, 1), //105
            vec4(-0.125, 0.25, 0.1625, 1), //106
            vec4(-0.125, 0.25, 0.1625, 1), //107
            vec4(-0.125, 0.25, 0.1625, 1), //108
            vec4(-0.125, 0.25, 0.1625, 1), //109
        };

        const vec4 colors[102] = {
// =========== Back =============
            vec4(), // 0
            vec4(), // 1
            vec4(), // 2
            vec4(), // 3
// =========== Side L =============
            vec4(), // 4
            vec4(), // 5
            vec4(), // 6
            vec4(), // 7
            vec4(), // 8
            vec4(), // 9
            vec4(), // 10
            vec4(), // 11
            vec4(), // 12
            vec4(), // 13
            vec4(), // 14
            vec4(), // 15
            vec4(), // 16
// =========== Side R =============
            vec4(), // 18
            vec4(), // 19
            vec4(), // 20
            vec4(), // 21
            vec4(), // 22
            vec4(), // 23
            vec4(), // 17
            vec4(), // 24
            vec4(), // 25
            vec4(), // 26
            vec4(), // 27
            vec4(), // 28
            vec4(), // 29
// =========== Window L/R =============
            vec4(), // 30
            vec4(), // 31
// =========== Wheel Well L =============
            vec4(), // 32
            vec4(), // 33
            vec4(), // 34
            vec4(), // 35
            vec4(), // 36
            vec4(), // 37
            vec4(), // 38
            vec4(), // 39
            vec4(), // 40
            vec4(), // 41
            vec4(), // 42
            vec4(), // 43
            vec4(), // 44
            vec4(), // 45
            vec4(), // 46
            vec4(), // 47
            vec4(), // 48
            vec4(), // 49
            vec4(), // 50
            vec4(), // 51
// =========== Wheel Well R =============
            vec4(), // 52
            vec4(), // 53
            vec4(), // 54
            vec4(), // 55
            vec4(), // 56
            vec4(), // 57
            vec4(), // 58
            vec4(), // 59
            vec4(), // 60
            vec4(), // 61
            vec4(), // 62
            vec4(), // 63
            vec4(), // 64
            vec4(), // 65
            vec4(), // 66
            vec4(), // 67
            vec4(), // 68
            vec4(), // 69
            vec4(), // 70
            vec4(), // 71
// =========== Top =============
            vec4(), // 72
            vec4(), // 73
            vec4(), // 74
            vec4(), // 75
// =========== Top Windows =============
            vec4(), // 76
            vec4(), // 77
// =========== Bottom  =============
            vec4(), // 78
            vec4(), // 79
            vec4(), // 80
            vec4(), // 81
            vec4(), // 82
            vec4(), // 83
            vec4(), // 84
            vec4(), // 85
            vec4(), // 86
            vec4(), // 87
// =========== Front =============
            vec4(), // 88
            vec4(), // 89
            vec4(), // 90
            vec4(), // 91
            vec4(), // 92
            vec4(), // 93
            vec4(), // 94
            vec4(), // 95
            vec4(), // 96
            vec4(), // 97
            vec4(), // 98
            vec4(), // 99
            vec4(), // 100
            vec4() // 101
        };

        const int face [102][4] = {
// =========== Back =============
            {2,3,4,5}, // 0
            {1,2,5,6}, // 1
            {9,0,1,6}, // 2
            {7,8,9,6}, // 3
// =========== Side L =============
            {5,4,24,24}, // 4
            {24,4,29,26}, // 5
            {4,17,44,29}, // 6
            {48,4,57,57}, // 7
            {57,4,56,56}, // 8
            {4,21,56,56}, // 9
            {56,21,19,55}, // 10
            {58,57,54,53}, // 11
            {32,29,44,39}, // 12
            {54,55,19,18}, // 13
            {17,54,18,18}, // 14
            {53,54,17,17}, // 15
            {17,48,47,44}, // 16
// =========== Side R =============
            {3,2,61,61}, // 17
            {3,61,63,67}, // 18
            {3,66,81,14}, // 19
            {3,95,94,94}, // 20
            {3,94,93,93}, // 21
            {3,93,10,10}, // 22
            {10,93,92,12}, // 23
            {94,95,90,91}, // 24
            {66,69,76,81}, // 25
            {12,92,91,13}, // 26
            {13,91,14,14}, // 27
            {91,90,14,14}, // 28
            {14,81,84,85}, // 29
// =========== Window L/R =============
            {54,57,56,55}, // 30
            {91,92,93,94}, // 31
// =========== Wheel Well L =============
            {7,6,23,22}, // 32
            {6,5,24,25}, // 33
            {25,24,27,28}, // 34
            {23,24,26,27}, // 35
            {28,27,30,31}, // 36
            {27,26,29,30}, // 37
            {34,31,30,33}, // 38
            {30,29,32,33}, // 39
            {34,33,36,35}, // 40
            {33,32,36,36}, // 41
            {36,32,39,38}, // 42
            {37,38,41,40}, // 43
            {38,39,41,41}, // 44
            {40,41,43,42}, // 45
            {41,39,44,43}, // 46
            {42,43,46,45}, // 47
            {43,44,47,46}, // 48
            {45,46,49,50}, // 49
            {46,47,48,49}, // 50
            {50,49,51,52}, // 51
// =========== Wheel Well R =============
            {0,59,60,1}, // 52
            {1,60,61,2}, // 53
            {62,65,64,60}, // 54
            {60,64,63,61}, // 55
            {65,68,67,64}, // 56
            {64,67,66,63}, // 57
            {68,71,70,67}, // 58
            {67,70,69,66}, // 59
            {71,72,73,70}, // 60
            {70,73,69,69}, // 61
            {73,75,76,69}, // 62
            {74,77,78,75}, // 63
            {75,78,76,76}, // 64
            {77,79,80,78}, // 65
            {78,80,81,76}, // 66
            {79,82,83,80}, // 67
            {80,83,84,81}, // 68
            {82,87,86,83}, // 69
            {83,86,85,84}, // 70
            {87,89,88,86}, // 71
// =========== Top =============
            {3,10,21,4}, // 72
            {11,12,19,20}, // 73
            {13,16,17,18}, // 74
            {13,14,15,16}, // 75
// =========== Top Windows =============
            {10,11,20,21}, // 76
            {12,13,18,19}, // 77
// =========== Bottom  =============
            {0,108,59,59}, // 78
            {0,9,108,108}, // 79
            {9,8,109,108}, // 80
            {8,7,109,109}, // 81
            {7,22,109,109}, // 82
            {108,109,36,73}, // 83
            {36,38,75,73}, // 84
            {38,106,107,75}, // 85
            {106,105,96,107}, // 86
            {105,104,97,96}, // 87
// =========== Front =============
            {14,15,100,85}, // 88
            {100,99,85,85}, // 89
            {85,88,86,86}, // 90
            {99,98,88,85}, // 91
            {97,96,88,98}, // 92
            {97,98,103,104}, // 93
            {102,103,98,99}, // 94
            {101,102,99,100}, // 95
            {101,100,15,16}, // 96
            {101,16,17,48}, // 97
            {101,48,102,102}, // 98
            {48,51,103,102}, // 99
            {51,105,104,103}, // 100
            {48,49,51,51} // 101
        };


        glGenVertexArrays(5, vao);
        glGenBuffers(5, buffer);

    for (int i = 0; i < 5; i++) {
      glBindVertexArray(vao[i]);

      // initialize a buffer object
      glBindBuffer(GL_ARRAY_BUFFER, buffer[i]);

          vec4 A[4];
        // No need for size variable since we always use 4 vertices
        for (int j = 0; j < 4; j++) {
            A[j] = point[face[i][j]];
         }

      glBufferData(GL_ARRAY_BUFFER, 4 * sizeof(vec4), A, GL_STATIC_DRAW);
glEnableVertexAttribArray( vertexLoc );
      glVertexAttribPointer( vertexLoc, 4, GL_FLOAT, GL_FALSE, 0,
                 BUFFER_OFFSET(0) );
    }

    model = Translate(pos) * RotateX(theta_x) * RotateY(theta_y) * RotateZ(theta_z)
            * Scale(scale_x, scale_y, scale_z);

    }

Car::~Car() 
{
    glDeleteVertexArrays(5, vao);
    glDeleteBuffers(5, buffer);
}


void Car::draw() const {
        glUniformMatrix4fv(model_loc, 1, GL_TRUE, model);

        const vec4 colors[102] = {
// =========== Back =============
            vec4(), // 0
            vec4(), // 1
            vec4(), // 2
            vec4(), // 3
// =========== Side L =============
            vec4(), // 4
            vec4(), // 5
            vec4(), // 6
            vec4(), // 7
            vec4(), // 8
            vec4(), // 9
            vec4(), // 10
            vec4(), // 11
            vec4(), // 12
            vec4(), // 13
            vec4(), // 14
            vec4(), // 15
            vec4(), // 16
// =========== Side R =============
            vec4(), // 18
            vec4(), // 19
            vec4(), // 20
            vec4(), // 21
            vec4(), // 22
            vec4(), // 23
            vec4(), // 17
            vec4(), // 24
            vec4(), // 25
            vec4(), // 26
            vec4(), // 27
            vec4(), // 28
            vec4(), // 29
// =========== Window L/R =============
            vec4(), // 30
            vec4(), // 31
// =========== Wheel Well L =============
            vec4(), // 32
            vec4(), // 33
            vec4(), // 34
            vec4(), // 35
            vec4(), // 36
            vec4(), // 37
            vec4(), // 38
            vec4(), // 39
            vec4(), // 40
            vec4(), // 41
            vec4(), // 42
            vec4(), // 43
            vec4(), // 44
            vec4(), // 45
            vec4(), // 46
            vec4(), // 47
            vec4(), // 48
            vec4(), // 49
            vec4(), // 50
            vec4(), // 51
// =========== Wheel Well R =============
            vec4(), // 52
            vec4(), // 53
            vec4(), // 54
            vec4(), // 55
            vec4(), // 56
            vec4(), // 57
            vec4(), // 58
            vec4(), // 59
            vec4(), // 60
            vec4(), // 61
            vec4(), // 62
            vec4(), // 63
            vec4(), // 64
            vec4(), // 65
            vec4(), // 66
            vec4(), // 67
            vec4(), // 68
            vec4(), // 69
            vec4(), // 70
            vec4(), // 71
// =========== Top =============
            vec4(), // 72
            vec4(), // 73
            vec4(), // 74
            vec4(), // 75
// =========== Top Windows =============
            vec4(), // 76
            vec4(), // 77
// =========== Bottom  =============
            vec4(), // 78
            vec4(), // 79
            vec4(), // 80
            vec4(), // 81
            vec4(), // 82
            vec4(), // 83
            vec4(), // 84
            vec4(), // 85
            vec4(), // 86
            vec4(), // 87
// =========== Front =============
            vec4(), // 88
            vec4(), // 89
            vec4(), // 90
            vec4(), // 91
            vec4(), // 92
            vec4(), // 93
            vec4(), // 94
            vec4(), // 95
            vec4(), // 96
            vec4(), // 97
            vec4(), // 98
            vec4(), // 99
            vec4(), // 100
            vec4() // 101
        };

for(int i = 0; i < 5; i++) {
  glBindVertexArray(vao[i]);
  glUniform4fv(face_loc, 1, colors[i]);
  // glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, buffer[i]);
  // glDrawElements(GL_TRIANGLE_FAN, 4, GL_UNSIGNED_INT, nullptr);
  glDrawArrays(GL_TRIANGLE_FAN, 0, 4);
}
}

vec4 Car::getPosition() const {
    return vec4(model[3][0], model[3][1], model[3][2], 1.0);
}
